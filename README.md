BlockEdfSpectralSummarizeFig
============================

Create spectral summaries and figures from spectral output generated from SpectralTrainFig.

#### Overview
BlockEdfSpectralSummarizeFig is a GUI that facilitates review of spectral analysis output generated by [SpectralTrainFig](http://www.mathworks.com/matlabcentral/fileexchange/49852-spectraltrainfig). Program is includes functions for visualizing, summarizing and adjudication of spectral output.

#### Application Functions
1. Select spectral summary file (Button with Elipses)
2. Set study test string that is used as a prefix for generated file names
3. Click 'Load' to load spectral summary file
4. Select Monitor to display results.
5. Edit signal labels to include in summary
6. Select adjudication summary if you have one.  Otherwise, data used in summary is by total power percentile.
7. Edit subject ID function to extract subject id from file name.
8. Click 'Idenitfy NaNs' to list subjects with out an entry.
9. Click 'Plot Total Power' to generate total power plots.
10. Click 'Plot Spectrograms' to generate total power plots.
11. Click 'Plot Average Spectra' to generate average spectra plots.
12. Click 'Band Plots' to generate band plots. function also creates subject and overall band averages.
13. Click 'About' to see version information.
14. Click 'Close All' to close generated figures.
15. Click 'Folder' to select location to write output files.
16. Click 'PPT' to create a power point summary of generated figures.
17. Click 'Quit' to terminate the applications.

#### GUI vs. Class
The GUI is designed to provide access to the BlockSpectralSummarizeClass.  The class includes public and private properties that can be accessed directly to tailor the spectral summary.  See the [BlockSpectralSummarizeClass](https://github.com/DennisDean/BlockEdfSpectralSummarizeFig/blob/master/BlockSpectralSummarizeClass.m) header for additional information.

#### Adjudication

Adjudication requires a file with id numbers in the first column and a column for each signal analyzed. The program expects that the id numbers in the summary file are included in the adjudication file. Subject signal entries are included in the analysis if the coreesponding adjudication value is set to 1. 

For analyeses that require complete data, the 'Adjudicate' button can be used to create a new spectral summary file that excludes all subjects; where at least one correspoinding signal adjudication entry is set to 0.  

No adjudication entry: For clean data sets it may be possible to remove non-physiological data by setting the 'Start Pctl' and 'End Pctl'.

#### Covariate File

The covaraite file should include a single header line. Subject ids should be listed in the first column.

#### Limitations

The adjudication options is not implemented in all functions.  Curently inplemented in the 'Plot Average Spectra' and 'Band Plots'.

#### Acknowledgements:

Uses:
* [saveppt2 (http://www.mathworks.com/matlabcentral/fileexchange/19322-saveppt2)](http://www.mathworks.com/matlabcentral/fileexchange/19322-saveppt2)
* [fixfig (http://www.mathworks.com/matlabcentral/fileexchange/24095-fixfig)](http://www.mathworks.com/matlabcentral/fileexchange/24095-fixfig)

#### Questions

Please post questions at [https://sleepdata.org/forum](https://sleepdata.org/forum)

#### Related Links

[National Sleep Research Resource (https://sleepdata.org/)](https://sleepdata.org/)

[Author's File Exchange Downloads (http://www.mathworks.com/matlabcentral/fileexchange/authors/my_fileexchange)](http://www.mathworks.com/matlabcentral/fileexchange/authors/my_fileexchange)

[Data Access and Visualization for Sleep Toolbox(https://github.com/DennisDean/DAVS-Toolbox/blob/master/README.md)](https://github.com/DennisDean/DAVS-Toolbox/blob/master/README.md)

[SpectralTrainFig (http://www.mathworks.com/matlabcentral/fileexchange/49852-spectraltrainfig)](http://www.mathworks.com/matlabcentral/fileexchange/49852-spectraltrainfig)
